function cov_1qcj8rfx54(){var path="/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/register-user.js";var hash="45340ef0ee2961b0a8a6c1a6b0bc72340edfdbea";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/register-user.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:51}},"1":{start:{line:2,column:29},end:{line:2,column:58}},"2":{start:{line:3,column:28},end:{line:3,column:59}},"3":{start:{line:4,column:15},end:{line:4,column:34}},"4":{start:{line:6,column:0},end:{line:26,column:1}},"5":{start:{line:7,column:4},end:{line:7,column:33}},"6":{start:{line:8,column:4},end:{line:8,column:39}},"7":{start:{line:9,column:4},end:{line:9,column:35}},"8":{start:{line:10,column:4},end:{line:10,column:25}},"9":{start:{line:11,column:4},end:{line:11,column:41}},"10":{start:{line:12,column:4},end:{line:12,column:41}},"11":{start:{line:14,column:4},end:{line:25,column:24}},"12":{start:{line:16,column:12},end:{line:16,column:90}},"13":{start:{line:16,column:22},end:{line:16,column:90}},"14":{start:{line:18,column:12},end:{line:18,column:44}},"15":{start:{line:21,column:12},end:{line:21,column:89}},"16":{start:{line:23,column:12},end:{line:23,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:60},end:{line:26,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:14},end:{line:15,column:15}},loc:{start:{line:15,column:22},end:{line:19,column:9}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:14},end:{line:20,column:15}},loc:{start:{line:20,column:26},end:{line:24,column:9}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:25,column:14},end:{line:25,column:15}},loc:{start:{line:25,column:20},end:{line:25,column:23}},line:25}},branchMap:{"0":{loc:{start:{line:16,column:12},end:{line:16,column:90}},type:"if",locations:[{start:{line:16,column:12},end:{line:16,column:90}},{start:{line:16,column:12},end:{line:16,column:90}}],line:16}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"45340ef0ee2961b0a8a6c1a6b0bc72340edfdbea"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1qcj8rfx54=function(){return actualCoverage;};return actualCoverage;}cov_1qcj8rfx54();const{validate}=(cov_1qcj8rfx54().s[0]++,require('share-my-spot-utils'));const{models:{User}}=(cov_1qcj8rfx54().s[1]++,require('share-my-spot-data'));const{NotAllowedError}=(cov_1qcj8rfx54().s[2]++,require('share-my-spot-errors'));const bcrypt=(cov_1qcj8rfx54().s[3]++,require('bcryptjs'));cov_1qcj8rfx54().s[4]++;module.exports=(name,surname,email,phone,password)=>{cov_1qcj8rfx54().f[0]++;cov_1qcj8rfx54().s[5]++;validate.string(name,'name');cov_1qcj8rfx54().s[6]++;validate.string(surname,'surname');cov_1qcj8rfx54().s[7]++;validate.string(email,'email');cov_1qcj8rfx54().s[8]++;validate.email(email);cov_1qcj8rfx54().s[9]++;validate.type(phone,'phone',Number);cov_1qcj8rfx54().s[10]++;validate.string(password,'password');cov_1qcj8rfx54().s[11]++;return User.findOne({email}).then(user=>{cov_1qcj8rfx54().f[1]++;cov_1qcj8rfx54().s[12]++;if(user){cov_1qcj8rfx54().b[0][0]++;cov_1qcj8rfx54().s[13]++;throw new NotAllowedError(`user with email ${email} already exists`);}else{cov_1qcj8rfx54().b[0][1]++;}cov_1qcj8rfx54().s[14]++;return bcrypt.hash(password,10);}).then(password=>{cov_1qcj8rfx54().f[2]++;cov_1qcj8rfx54().s[15]++;user=new User({name,surname,email,phone,password,created:new Date()});cov_1qcj8rfx54().s[16]++;return user.save();}).then(()=>{cov_1qcj8rfx54().f[3]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZ2lzdGVyLXVzZXIuanMiXSwibmFtZXMiOlsidmFsaWRhdGUiLCJyZXF1aXJlIiwibW9kZWxzIiwiVXNlciIsIk5vdEFsbG93ZWRFcnJvciIsImJjcnlwdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJuYW1lIiwic3VybmFtZSIsImVtYWlsIiwicGhvbmUiLCJwYXNzd29yZCIsInN0cmluZyIsInR5cGUiLCJOdW1iZXIiLCJmaW5kT25lIiwidGhlbiIsInVzZXIiLCJoYXNoIiwiY3JlYXRlZCIsIkRhdGUiLCJzYXZlIl0sIm1hcHBpbmdzIjoid3FGQUFBLEtBQU0sQ0FBRUEsUUFBRiwyQkFBZUMsT0FBTyxDQUFDLHFCQUFELENBQXRCLENBQU4sQ0FDQSxLQUFNLENBQUVDLE1BQU0sQ0FBRSxDQUFFQyxJQUFGLENBQVYsMkJBQXVCRixPQUFPLENBQUMsb0JBQUQsQ0FBOUIsQ0FBTixDQUNBLEtBQU0sQ0FBRUcsZUFBRiwyQkFBc0JILE9BQU8sQ0FBQyxzQkFBRCxDQUE3QixDQUFOLENBQ0EsS0FBTUksQ0FBQUEsTUFBTSwwQkFBR0osT0FBTyxDQUFDLFVBQUQsQ0FBVixDQUFaLEMsd0JBRUFLLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxJQUFELENBQU9DLE9BQVAsQ0FBZ0JDLEtBQWhCLENBQXVCQyxLQUF2QixDQUE4QkMsUUFBOUIsR0FBMkMsaURBQ3hEWixRQUFRLENBQUNhLE1BQVQsQ0FBZ0JMLElBQWhCLENBQXNCLE1BQXRCLEVBRHdELHdCQUV4RFIsUUFBUSxDQUFDYSxNQUFULENBQWdCSixPQUFoQixDQUF5QixTQUF6QixFQUZ3RCx3QkFHeERULFFBQVEsQ0FBQ2EsTUFBVCxDQUFnQkgsS0FBaEIsQ0FBdUIsT0FBdkIsRUFId0Qsd0JBSXhEVixRQUFRLENBQUNVLEtBQVQsQ0FBZUEsS0FBZixFQUp3RCx3QkFLeERWLFFBQVEsQ0FBQ2MsSUFBVCxDQUFjSCxLQUFkLENBQXFCLE9BQXJCLENBQThCSSxNQUE5QixFQUx3RCx5QkFNeERmLFFBQVEsQ0FBQ2EsTUFBVCxDQUFnQkQsUUFBaEIsQ0FBMEIsVUFBMUIsRUFOd0QseUJBUXhELE1BQU9ULENBQUFBLElBQUksQ0FBQ2EsT0FBTCxDQUFhLENBQUVOLEtBQUYsQ0FBYixFQUNGTyxJQURFLENBQ0dDLElBQUksRUFBSSxrREFDVixHQUFJQSxJQUFKLENBQVUsMERBQU0sSUFBSWQsQ0FBQUEsZUFBSixDQUFxQixtQkFBa0JNLEtBQU0saUJBQTdDLENBQU4sQ0FBb0UsQ0FBOUUsaUNBRFUseUJBR1YsTUFBT0wsQ0FBQUEsTUFBTSxDQUFDYyxJQUFQLENBQVlQLFFBQVosQ0FBc0IsRUFBdEIsQ0FBUCxDQUNILENBTEUsRUFNRkssSUFORSxDQU1HTCxRQUFRLEVBQUksa0RBQ2RNLElBQUksQ0FBRyxHQUFJZixDQUFBQSxJQUFKLENBQVMsQ0FBRUssSUFBRixDQUFRQyxPQUFSLENBQWlCQyxLQUFqQixDQUF3QkMsS0FBeEIsQ0FBK0JDLFFBQS9CLENBQXlDUSxPQUFPLENBQUUsR0FBSUMsQ0FBQUEsSUFBSixFQUFsRCxDQUFULENBQVAsQ0FEYyx5QkFHZCxNQUFPSCxDQUFBQSxJQUFJLENBQUNJLElBQUwsRUFBUCxDQUNILENBVkUsRUFXRkwsSUFYRSxDQVdHLElBQU0seUJBQUcsQ0FYWixDQUFQLENBWUgsQ0FwQkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRlIH0gPSByZXF1aXJlKCdzaGFyZS1teS1zcG90LXV0aWxzJylcbmNvbnN0IHsgbW9kZWxzOiB7IFVzZXIgfSB9ID0gcmVxdWlyZSgnc2hhcmUtbXktc3BvdC1kYXRhJylcbmNvbnN0IHsgTm90QWxsb3dlZEVycm9yIH0gPSByZXF1aXJlKCdzaGFyZS1teS1zcG90LWVycm9ycycpXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpXG5cbm1vZHVsZS5leHBvcnRzID0gKG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwaG9uZSwgcGFzc3dvcmQpID0+IHtcbiAgICB2YWxpZGF0ZS5zdHJpbmcobmFtZSwgJ25hbWUnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhzdXJuYW1lLCAnc3VybmFtZScpXG4gICAgdmFsaWRhdGUuc3RyaW5nKGVtYWlsLCAnZW1haWwnKVxuICAgIHZhbGlkYXRlLmVtYWlsKGVtYWlsKVxuICAgIHZhbGlkYXRlLnR5cGUocGhvbmUsICdwaG9uZScsIE51bWJlcilcbiAgICB2YWxpZGF0ZS5zdHJpbmcocGFzc3dvcmQsICdwYXNzd29yZCcpXG5cbiAgICByZXR1cm4gVXNlci5maW5kT25lKHsgZW1haWwgfSlcbiAgICAgICAgLnRoZW4odXNlciA9PiB7XG4gICAgICAgICAgICBpZiAodXNlcikgdGhyb3cgbmV3IE5vdEFsbG93ZWRFcnJvcihgdXNlciB3aXRoIGVtYWlsICR7ZW1haWx9IGFscmVhZHkgZXhpc3RzYClcblxuICAgICAgICAgICAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMClcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocGFzc3dvcmQgPT4ge1xuICAgICAgICAgICAgdXNlciA9IG5ldyBVc2VyKHsgbmFtZSwgc3VybmFtZSwgZW1haWwsIHBob25lLCBwYXNzd29yZCwgY3JlYXRlZDogbmV3IERhdGUgfSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHVzZXIuc2F2ZSgpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHsgfSlcbn0iXX0=