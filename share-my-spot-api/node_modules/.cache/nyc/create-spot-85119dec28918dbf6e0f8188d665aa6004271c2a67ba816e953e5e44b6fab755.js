function cov_2o01c9311x(){var path="/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/create-spot.js";var hash="7e81b56fe24c55309a088077aa4876b05372c83f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/create-spot.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:51}},"1":{start:{line:2,column:35},end:{line:2,column:64}},"2":{start:{line:3,column:11},end:{line:3,column:33}},"3":{start:{line:4,column:13},end:{line:4,column:28}},"4":{start:{line:5,column:26},end:{line:5,column:57}},"5":{start:{line:7,column:17},end:{line:7,column:54}},"6":{start:{line:9,column:0},end:{line:87,column:1}},"7":{start:{line:10,column:4},end:{line:10,column:47}},"8":{start:{line:11,column:4},end:{line:11,column:35}},"9":{start:{line:12,column:4},end:{line:12,column:55}},"10":{start:{line:13,column:4},end:{line:13,column:55}},"11":{start:{line:14,column:4},end:{line:14,column:49}},"12":{start:{line:15,column:4},end:{line:15,column:43}},"13":{start:{line:16,column:4},end:{line:16,column:41}},"14":{start:{line:17,column:4},end:{line:17,column:43}},"15":{start:{line:18,column:4},end:{line:18,column:39}},"16":{start:{line:19,column:4},end:{line:19,column:47}},"17":{start:{line:20,column:4},end:{line:20,column:41}},"18":{start:{line:22,column:4},end:{line:25,column:5}},"19":{start:{line:23,column:8},end:{line:23,column:78}},"20":{start:{line:24,column:8},end:{line:24,column:62}},"21":{start:{line:27,column:4},end:{line:30,column:5}},"22":{start:{line:28,column:8},end:{line:28,column:75}},"23":{start:{line:29,column:8},end:{line:29,column:60}},"24":{start:{line:32,column:4},end:{line:35,column:5}},"25":{start:{line:33,column:8},end:{line:33,column:66}},"26":{start:{line:34,column:8},end:{line:34,column:54}},"27":{start:{line:37,column:4},end:{line:37,column:45}},"28":{start:{line:38,column:4},end:{line:38,column:41}},"29":{start:{line:40,column:4},end:{line:43,column:5}},"30":{start:{line:41,column:8},end:{line:41,column:48}},"31":{start:{line:42,column:8},end:{line:42,column:42}},"32":{start:{line:45,column:4},end:{line:48,column:5}},"33":{start:{line:46,column:8},end:{line:46,column:48}},"34":{start:{line:47,column:8},end:{line:47,column:42}},"35":{start:{line:50,column:4},end:{line:53,column:5}},"36":{start:{line:51,column:8},end:{line:51,column:48}},"37":{start:{line:52,column:8},end:{line:52,column:42}},"38":{start:{line:55,column:4},end:{line:58,column:5}},"39":{start:{line:56,column:8},end:{line:56,column:48}},"40":{start:{line:57,column:8},end:{line:57,column:42}},"41":{start:{line:60,column:4},end:{line:63,column:5}},"42":{start:{line:61,column:8},end:{line:61,column:48}},"43":{start:{line:62,column:8},end:{line:62,column:42}},"44":{start:{line:65,column:4},end:{line:68,column:5}},"45":{start:{line:66,column:8},end:{line:66,column:48}},"46":{start:{line:67,column:8},end:{line:67,column:42}},"47":{start:{line:70,column:4},end:{line:73,column:5}},"48":{start:{line:71,column:8},end:{line:71,column:48}},"49":{start:{line:72,column:8},end:{line:72,column:42}},"50":{start:{line:75,column:4},end:{line:86,column:10}},"51":{start:{line:77,column:12},end:{line:77,column:92}},"52":{start:{line:77,column:23},end:{line:77,column:92}},"53":{start:{line:79,column:25},end:{line:79,column:270}},"54":{start:{line:81,column:12},end:{line:81,column:45}},"55":{start:{line:83,column:12},end:{line:85,column:36}},"56":{start:{line:84,column:28},end:{line:84,column:66}},"57":{start:{line:85,column:28},end:{line:85,column:35}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:17},end:{line:9,column:18}},loc:{start:{line:9,column:235},end:{line:87,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:76,column:14},end:{line:76,column:15}},loc:{start:{line:76,column:22},end:{line:86,column:9}},line:76},"2":{name:"(anonymous_2)",decl:{start:{line:84,column:22},end:{line:84,column:23}},loc:{start:{line:84,column:28},end:{line:84,column:66}},line:84},"3":{name:"(anonymous_3)",decl:{start:{line:85,column:22},end:{line:85,column:23}},loc:{start:{line:85,column:28},end:{line:85,column:35}},line:85}},branchMap:{"0":{loc:{start:{line:22,column:4},end:{line:25,column:5}},type:"if",locations:[{start:{line:22,column:4},end:{line:25,column:5}},{start:{line:22,column:4},end:{line:25,column:5}}],line:22},"1":{loc:{start:{line:23,column:8},end:{line:23,column:78}},type:"cond-expr",locations:[{start:{line:23,column:34},end:{line:23,column:54}},{start:{line:23,column:57},end:{line:23,column:78}}],line:23},"2":{loc:{start:{line:27,column:4},end:{line:30,column:5}},type:"if",locations:[{start:{line:27,column:4},end:{line:30,column:5}},{start:{line:27,column:4},end:{line:30,column:5}}],line:27},"3":{loc:{start:{line:28,column:8},end:{line:28,column:75}},type:"cond-expr",locations:[{start:{line:28,column:33},end:{line:28,column:52}},{start:{line:28,column:55},end:{line:28,column:75}}],line:28},"4":{loc:{start:{line:32,column:4},end:{line:35,column:5}},type:"if",locations:[{start:{line:32,column:4},end:{line:35,column:5}},{start:{line:32,column:4},end:{line:35,column:5}}],line:32},"5":{loc:{start:{line:33,column:8},end:{line:33,column:66}},type:"cond-expr",locations:[{start:{line:33,column:30},end:{line:33,column:46}},{start:{line:33,column:49},end:{line:33,column:66}}],line:33},"6":{loc:{start:{line:40,column:4},end:{line:43,column:5}},type:"if",locations:[{start:{line:40,column:4},end:{line:43,column:5}},{start:{line:40,column:4},end:{line:43,column:5}}],line:40},"7":{loc:{start:{line:41,column:8},end:{line:41,column:48}},type:"cond-expr",locations:[{start:{line:41,column:24},end:{line:41,column:34}},{start:{line:41,column:37},end:{line:41,column:48}}],line:41},"8":{loc:{start:{line:45,column:4},end:{line:48,column:5}},type:"if",locations:[{start:{line:45,column:4},end:{line:48,column:5}},{start:{line:45,column:4},end:{line:48,column:5}}],line:45},"9":{loc:{start:{line:46,column:8},end:{line:46,column:48}},type:"cond-expr",locations:[{start:{line:46,column:24},end:{line:46,column:34}},{start:{line:46,column:37},end:{line:46,column:48}}],line:46},"10":{loc:{start:{line:50,column:4},end:{line:53,column:5}},type:"if",locations:[{start:{line:50,column:4},end:{line:53,column:5}},{start:{line:50,column:4},end:{line:53,column:5}}],line:50},"11":{loc:{start:{line:51,column:8},end:{line:51,column:48}},type:"cond-expr",locations:[{start:{line:51,column:24},end:{line:51,column:34}},{start:{line:51,column:37},end:{line:51,column:48}}],line:51},"12":{loc:{start:{line:55,column:4},end:{line:58,column:5}},type:"if",locations:[{start:{line:55,column:4},end:{line:58,column:5}},{start:{line:55,column:4},end:{line:58,column:5}}],line:55},"13":{loc:{start:{line:56,column:8},end:{line:56,column:48}},type:"cond-expr",locations:[{start:{line:56,column:24},end:{line:56,column:34}},{start:{line:56,column:37},end:{line:56,column:48}}],line:56},"14":{loc:{start:{line:60,column:4},end:{line:63,column:5}},type:"if",locations:[{start:{line:60,column:4},end:{line:63,column:5}},{start:{line:60,column:4},end:{line:63,column:5}}],line:60},"15":{loc:{start:{line:61,column:8},end:{line:61,column:48}},type:"cond-expr",locations:[{start:{line:61,column:24},end:{line:61,column:34}},{start:{line:61,column:37},end:{line:61,column:48}}],line:61},"16":{loc:{start:{line:65,column:4},end:{line:68,column:5}},type:"if",locations:[{start:{line:65,column:4},end:{line:68,column:5}},{start:{line:65,column:4},end:{line:68,column:5}}],line:65},"17":{loc:{start:{line:66,column:8},end:{line:66,column:48}},type:"cond-expr",locations:[{start:{line:66,column:24},end:{line:66,column:34}},{start:{line:66,column:37},end:{line:66,column:48}}],line:66},"18":{loc:{start:{line:70,column:4},end:{line:73,column:5}},type:"if",locations:[{start:{line:70,column:4},end:{line:73,column:5}},{start:{line:70,column:4},end:{line:73,column:5}}],line:70},"19":{loc:{start:{line:71,column:8},end:{line:71,column:48}},type:"cond-expr",locations:[{start:{line:71,column:24},end:{line:71,column:34}},{start:{line:71,column:37},end:{line:71,column:48}}],line:71},"20":{loc:{start:{line:77,column:12},end:{line:77,column:92}},type:"if",locations:[{start:{line:77,column:12},end:{line:77,column:92}},{start:{line:77,column:12},end:{line:77,column:92}}],line:77}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"7e81b56fe24c55309a088077aa4876b05372c83f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2o01c9311x=function(){return actualCoverage;};return actualCoverage;}cov_2o01c9311x();const{validate}=(cov_2o01c9311x().s[0]++,require('share-my-spot-utils'));const{models:{User,Spot}}=(cov_2o01c9311x().s[1]++,require('share-my-spot-data'));const fs=(cov_2o01c9311x().s[2]++,require('fs').promises);const path=(cov_2o01c9311x().s[3]++,require('path'));const{NotFoundError}=(cov_2o01c9311x().s[4]++,require('share-my-spot-errors'));const filesDir=(cov_2o01c9311x().s[5]++,path.join(__dirname,`../data/spots`));cov_2o01c9311x().s[6]++;module.exports=(publisherId,title,addressLocation,addressStNumber,addressOther,length,width,height,area,description,price,acceptsBarker,surveillance,isCovered,hourStarts,hourEnds,mon,tue,wed,thu,fri,sat,sun)=>{cov_2o01c9311x().f[0]++;cov_2o01c9311x().s[7]++;validate.string(publisherId,'publisherId');cov_2o01c9311x().s[8]++;validate.string(title,'title');cov_2o01c9311x().s[9]++;validate.string(addressLocation,'addressLocation');cov_2o01c9311x().s[10]++;validate.string(addressStNumber,'addressStNumber');cov_2o01c9311x().s[11]++;validate.string(addressOther,'addressOther');cov_2o01c9311x().s[12]++;validate.type(length,'length',Number);cov_2o01c9311x().s[13]++;validate.type(width,'width',Number);cov_2o01c9311x().s[14]++;validate.type(height,'height',Number);cov_2o01c9311x().s[15]++;validate.type(area,'area',Number);cov_2o01c9311x().s[16]++;validate.string(description,'description');cov_2o01c9311x().s[17]++;validate.type(price,'price',Number);cov_2o01c9311x().s[18]++;if(typeof acceptsBarker!=='undefined'){cov_2o01c9311x().b[0][0]++;cov_2o01c9311x().s[19]++;acceptsBarker==='yes'?(cov_2o01c9311x().b[1][0]++,acceptsBarker=true):(cov_2o01c9311x().b[1][1]++,acceptsBarker=false);cov_2o01c9311x().s[20]++;validate.type(acceptsBarker,'acceptsBarker',Boolean);}else{cov_2o01c9311x().b[0][1]++;}cov_2o01c9311x().s[21]++;if(typeof surveillance!=='undefined'){cov_2o01c9311x().b[2][0]++;cov_2o01c9311x().s[22]++;surveillance==='yes'?(cov_2o01c9311x().b[3][0]++,surveillance=true):(cov_2o01c9311x().b[3][1]++,surveillance=false);cov_2o01c9311x().s[23]++;validate.type(surveillance,'surveillance',Boolean);}else{cov_2o01c9311x().b[2][1]++;}cov_2o01c9311x().s[24]++;if(typeof isCovered!=='undefined'){cov_2o01c9311x().b[4][0]++;cov_2o01c9311x().s[25]++;isCovered==='yes'?(cov_2o01c9311x().b[5][0]++,isCovered=true):(cov_2o01c9311x().b[5][1]++,isCovered=false);cov_2o01c9311x().s[26]++;validate.type(isCovered,'isCovered',Boolean);}else{cov_2o01c9311x().b[4][1]++;}cov_2o01c9311x().s[27]++;validate.string(hourStarts,'hourStarts');cov_2o01c9311x().s[28]++;validate.string(hourEnds,'hourEnds');cov_2o01c9311x().s[29]++;if(typeof mon!=='undefined'){cov_2o01c9311x().b[6][0]++;cov_2o01c9311x().s[30]++;mon==='yes'?(cov_2o01c9311x().b[7][0]++,mon=true):(cov_2o01c9311x().b[7][1]++,mon=false);cov_2o01c9311x().s[31]++;validate.type(mon,'mon',Boolean);}else{cov_2o01c9311x().b[6][1]++;}cov_2o01c9311x().s[32]++;if(typeof tue!=='undefined'){cov_2o01c9311x().b[8][0]++;cov_2o01c9311x().s[33]++;tue==='yes'?(cov_2o01c9311x().b[9][0]++,tue=true):(cov_2o01c9311x().b[9][1]++,tue=false);cov_2o01c9311x().s[34]++;validate.type(tue,'tue',Boolean);}else{cov_2o01c9311x().b[8][1]++;}cov_2o01c9311x().s[35]++;if(typeof wed!=='undefined'){cov_2o01c9311x().b[10][0]++;cov_2o01c9311x().s[36]++;wed==='yes'?(cov_2o01c9311x().b[11][0]++,wed=true):(cov_2o01c9311x().b[11][1]++,wed=false);cov_2o01c9311x().s[37]++;validate.type(wed,'wed',Boolean);}else{cov_2o01c9311x().b[10][1]++;}cov_2o01c9311x().s[38]++;if(typeof thu!=='undefined'){cov_2o01c9311x().b[12][0]++;cov_2o01c9311x().s[39]++;thu==='yes'?(cov_2o01c9311x().b[13][0]++,thu=true):(cov_2o01c9311x().b[13][1]++,thu=false);cov_2o01c9311x().s[40]++;validate.type(thu,'thu',Boolean);}else{cov_2o01c9311x().b[12][1]++;}cov_2o01c9311x().s[41]++;if(typeof fri!=='undefined'){cov_2o01c9311x().b[14][0]++;cov_2o01c9311x().s[42]++;fri==='yes'?(cov_2o01c9311x().b[15][0]++,fri=true):(cov_2o01c9311x().b[15][1]++,fri=false);cov_2o01c9311x().s[43]++;validate.type(fri,'fri',Boolean);}else{cov_2o01c9311x().b[14][1]++;}cov_2o01c9311x().s[44]++;if(typeof sat!=='undefined'){cov_2o01c9311x().b[16][0]++;cov_2o01c9311x().s[45]++;sat==='yes'?(cov_2o01c9311x().b[17][0]++,sat=true):(cov_2o01c9311x().b[17][1]++,sat=false);cov_2o01c9311x().s[46]++;validate.type(sat,'sat',Boolean);}else{cov_2o01c9311x().b[16][1]++;}cov_2o01c9311x().s[47]++;if(typeof sun!=='undefined'){cov_2o01c9311x().b[18][0]++;cov_2o01c9311x().s[48]++;sun==='yes'?(cov_2o01c9311x().b[19][0]++,sun=true):(cov_2o01c9311x().b[19][1]++,sun=false);cov_2o01c9311x().s[49]++;validate.type(sun,'sun',Boolean);}else{cov_2o01c9311x().b[18][1]++;}cov_2o01c9311x().s[50]++;return User.findById(publisherId).then(user=>{cov_2o01c9311x().f[1]++;cov_2o01c9311x().s[51]++;if(!user){cov_2o01c9311x().b[20][0]++;cov_2o01c9311x().s[52]++;throw new NotFoundError(`user with id ${publisherId} does not exist`);}else{cov_2o01c9311x().b[20][1]++;}const spot=(cov_2o01c9311x().s[53]++,new Spot({publisherId,title,addressLocation,addressStNumber,addressOther,length,width,height,area,description,price,acceptsBarker,surveillance,isCovered,hourStarts,hourEnds,mon,tue,wed,thu,fri,sat,sun,created:new Date()}));cov_2o01c9311x().s[54]++;user.publishedSpots.push(spot.id);cov_2o01c9311x().s[55]++;return Promise.all([user.save(),spot.save()]).then(()=>{cov_2o01c9311x().f[2]++;cov_2o01c9311x().s[56]++;return fs.mkdir(path.join(filesDir,spot.id));}).then(()=>{cov_2o01c9311x().f[3]++;cov_2o01c9311x().s[57]++;return spot.id;});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZS1zcG90LmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIlVzZXIiLCJTcG90IiwiZnMiLCJwcm9taXNlcyIsInBhdGgiLCJOb3RGb3VuZEVycm9yIiwiZmlsZXNEaXIiLCJqb2luIiwiX19kaXJuYW1lIiwibW9kdWxlIiwiZXhwb3J0cyIsInB1Ymxpc2hlcklkIiwidGl0bGUiLCJhZGRyZXNzTG9jYXRpb24iLCJhZGRyZXNzU3ROdW1iZXIiLCJhZGRyZXNzT3RoZXIiLCJsZW5ndGgiLCJ3aWR0aCIsImhlaWdodCIsImFyZWEiLCJkZXNjcmlwdGlvbiIsInByaWNlIiwiYWNjZXB0c0JhcmtlciIsInN1cnZlaWxsYW5jZSIsImlzQ292ZXJlZCIsImhvdXJTdGFydHMiLCJob3VyRW5kcyIsIm1vbiIsInR1ZSIsIndlZCIsInRodSIsImZyaSIsInNhdCIsInN1biIsInN0cmluZyIsInR5cGUiLCJOdW1iZXIiLCJCb29sZWFuIiwiZmluZEJ5SWQiLCJ0aGVuIiwidXNlciIsInNwb3QiLCJjcmVhdGVkIiwiRGF0ZSIsInB1Ymxpc2hlZFNwb3RzIiwicHVzaCIsImlkIiwiUHJvbWlzZSIsImFsbCIsInNhdmUiLCJta2RpciJdLCJtYXBwaW5ncyI6Ind1U0FBQSxLQUFNLENBQUVBLFFBQUYsMkJBQWVDLE9BQU8sQ0FBQyxxQkFBRCxDQUF0QixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFRQyxJQUFSLENBQVYsMkJBQTZCSCxPQUFPLENBQUMsb0JBQUQsQ0FBcEMsQ0FBTixDQUNBLEtBQU1JLENBQUFBLEVBQUUsMEJBQUdKLE9BQU8sQ0FBQyxJQUFELENBQVAsQ0FBY0ssUUFBakIsQ0FBUixDQUNBLEtBQU1DLENBQUFBLElBQUksMEJBQUdOLE9BQU8sQ0FBQyxNQUFELENBQVYsQ0FBVixDQUNBLEtBQU0sQ0FBRU8sYUFBRiwyQkFBb0JQLE9BQU8sQ0FBQyxzQkFBRCxDQUEzQixDQUFOLENB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LENBQW1HQyxXQUFuRyxDQUFnSEMsS0FBaEgsQ0FBdUhDLGFBQXZILENBQXNJQyxZQUF0SSxDQUFvSkMsU0FBcEosQ0FBK0pDLFVBQS9KLENBQTJLQyxRQUEzSyxDQUFxTEMsR0FBckwsQ0FBMExDLEdBQTFMLENBQStMQyxHQUEvTCxDQUFvTUMsR0FBcE0sQ0FBeU1DLEdBQXpNLENBQThNQyxHQUE5TSxDQUFtTkMsR0FBbk4sQ0FBd05TLE9BQU8sQ0FBRSxHQUFJQyxDQUFBQSxJQUFKLEVBQWpPLENBQVQsQ0FBSCxDQUFWLENBSFUseUJBS1ZILElBQUksQ0FBQ0ksY0FBTCxDQUFvQkMsSUFBcEIsQ0FBeUJKLElBQUksQ0FBQ0ssRUFBOUIsRUFMVSx5QkFPVixNQUFPQyxDQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxDQUFDUixJQUFJLENBQUNTLElBQUwsRUFBRCxDQUFjUixJQUFJLENBQUNRLElBQUwsRUFBZCxDQUFaLEVBQ0ZWLElBREUsQ0FDRyxJQUFNLHdEQUFBckMsQ0FBQUEsRUFBRSxDQUFDZ0QsS0FBSCxDQUFTOUMsSUFBSSxDQUFDRyxJQUFMLENBQVVELFFBQVYsQ0FBb0JtQyxJQUFJLENBQUNLLEVBQXpCLENBQVQsRUFBc0MsQ0FEL0MsRUFFRlAsSUFGRSxDQUVHLElBQU0sd0RBQUFFLENBQUFBLElBQUksQ0FBQ0ssRUFBTCxDQUFPLENBRmhCLENBQVAsQ0FHSCxDQVhFLENBQVAsQ0FZSCxDQTlFRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgdmFsaWRhdGUgfSA9IHJlcXVpcmUoJ3NoYXJlLW15LXNwb3QtdXRpbHMnKVxuY29uc3QgeyBtb2RlbHM6IHsgVXNlciwgU3BvdCB9IH0gPSByZXF1aXJlKCdzaGFyZS1teS1zcG90LWRhdGEnKVxuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpLnByb21pc2VzXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5jb25zdCB7IE5vdEZvdW5kRXJyb3IgfSA9IHJlcXVpcmUoJ3NoYXJlLW15LXNwb3QtZXJyb3JzJylcblxuY29uc3QgZmlsZXNEaXIgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCBgLi4vZGF0YS9zcG90c2ApXG5cbm1vZHVsZS5leHBvcnRzID0gKHB1Ymxpc2hlcklkLCB0aXRsZSwgYWRkcmVzc0xvY2F0aW9uLCBhZGRyZXNzU3ROdW1iZXIsIGFkZHJlc3NPdGhlciwgbGVuZ3RoLCB3aWR0aCwgaGVpZ2h0LCBhcmVhLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGFjY2VwdHNCYXJrZXIsIHN1cnZlaWxsYW5jZSwgaXNDb3ZlcmVkLCBob3VyU3RhcnRzLCBob3VyRW5kcywgbW9uLCB0dWUsIHdlZCwgdGh1LCBmcmksIHNhdCwgc3VuKSA9PiB7XG4gICAgdmFsaWRhdGUuc3RyaW5nKHB1Ymxpc2hlcklkLCAncHVibGlzaGVySWQnKVxuICAgIHZhbGlkYXRlLnN0cmluZyh0aXRsZSwgJ3RpdGxlJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcoYWRkcmVzc0xvY2F0aW9uLCAnYWRkcmVzc0xvY2F0aW9uJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcoYWRkcmVzc1N0TnVtYmVyLCAnYWRkcmVzc1N0TnVtYmVyJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcoYWRkcmVzc090aGVyLCAnYWRkcmVzc090aGVyJylcbiAgICB2YWxpZGF0ZS50eXBlKGxlbmd0aCwgJ2xlbmd0aCcsIE51bWJlcilcbiAgICB2YWxpZGF0ZS50eXBlKHdpZHRoLCAnd2lkdGgnLCBOdW1iZXIpXG4gICAgdmFsaWRhdGUudHlwZShoZWlnaHQsICdoZWlnaHQnLCBOdW1iZXIpXG4gICAgdmFsaWRhdGUudHlwZShhcmVhLCAnYXJlYScsIE51bWJlcilcbiAgICB2YWxpZGF0ZS5zdHJpbmcoZGVzY3JpcHRpb24sICdkZXNjcmlwdGlvbicpXG4gICAgdmFsaWRhdGUudHlwZShwcmljZSwgJ3ByaWNlJywgTnVtYmVyKVxuXG4gICAgaWYgKHR5cGVvZiBhY2NlcHRzQmFya2VyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBhY2NlcHRzQmFya2VyID09PSAneWVzJyA/IGFjY2VwdHNCYXJrZXIgPSB0cnVlIDogYWNjZXB0c0JhcmtlciA9IGZhbHNlXG4gICAgICAgIHZhbGlkYXRlLnR5cGUoYWNjZXB0c0JhcmtlciwgJ2FjY2VwdHNCYXJrZXInLCBCb29sZWFuKVxuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygc3VydmVpbGxhbmNlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBzdXJ2ZWlsbGFuY2UgPT09ICd5ZXMnID8gc3VydmVpbGxhbmNlID0gdHJ1ZSA6IHN1cnZlaWxsYW5jZSA9IGZhbHNlXG4gICAgICAgIHZhbGlkYXRlLnR5cGUoc3VydmVpbGxhbmNlLCAnc3VydmVpbGxhbmNlJywgQm9vbGVhbilcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGlzQ292ZXJlZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgaXNDb3ZlcmVkID09PSAneWVzJyA/IGlzQ292ZXJlZCA9IHRydWUgOiBpc0NvdmVyZWQgPSBmYWxzZVxuICAgICAgICB2YWxpZGF0ZS50eXBlKGlzQ292ZXJlZCwgJ2lzQ292ZXJlZCcsIEJvb2xlYW4pXG4gICAgfVxuXG4gICAgdmFsaWRhdGUuc3RyaW5nKGhvdXJTdGFydHMsICdob3VyU3RhcnRzJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcoaG91ckVuZHMsICdob3VyRW5kcycpXG5cbiAgICBpZiAodHlwZW9mIG1vbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgbW9uID09PSAneWVzJyA/IG1vbiA9IHRydWUgOiBtb24gPSBmYWxzZVxuICAgICAgICB2YWxpZGF0ZS50eXBlKG1vbiwgJ21vbicsIEJvb2xlYW4pXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0dWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHR1ZSA9PT0gJ3llcycgPyB0dWUgPSB0cnVlIDogdHVlID0gZmFsc2VcbiAgICAgICAgdmFsaWRhdGUudHlwZSh0dWUsICd0dWUnLCBCb29sZWFuKVxuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygd2VkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3ZWQgPT09ICd5ZXMnID8gd2VkID0gdHJ1ZSA6IHdlZCA9IGZhbHNlXG4gICAgICAgIHZhbGlkYXRlLnR5cGUod2VkLCAnd2VkJywgQm9vbGVhbilcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHRodSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdGh1ID09PSAneWVzJyA/IHRodSA9IHRydWUgOiB0aHUgPSBmYWxzZVxuICAgICAgICB2YWxpZGF0ZS50eXBlKHRodSwgJ3RodScsIEJvb2xlYW4pXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBmcmkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGZyaSA9PT0gJ3llcycgPyBmcmkgPSB0cnVlIDogZnJpID0gZmFsc2VcbiAgICAgICAgdmFsaWRhdGUudHlwZShmcmksICdmcmknLCBCb29sZWFuKVxuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygc2F0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBzYXQgPT09ICd5ZXMnID8gc2F0ID0gdHJ1ZSA6IHNhdCA9IGZhbHNlXG4gICAgICAgIHZhbGlkYXRlLnR5cGUoc2F0LCAnc2F0JywgQm9vbGVhbilcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHN1biAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgc3VuID09PSAneWVzJyA/IHN1biA9IHRydWUgOiBzdW4gPSBmYWxzZVxuICAgICAgICB2YWxpZGF0ZS50eXBlKHN1biwgJ3N1bicsIEJvb2xlYW4pXG4gICAgfVxuXG4gICAgcmV0dXJuIFVzZXIuZmluZEJ5SWQocHVibGlzaGVySWQpXG4gICAgICAgIC50aGVuKHVzZXIgPT4ge1xuICAgICAgICAgICAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcihgdXNlciB3aXRoIGlkICR7cHVibGlzaGVySWR9IGRvZXMgbm90IGV4aXN0YClcblxuICAgICAgICAgICAgY29uc3Qgc3BvdCA9IG5ldyBTcG90KHsgcHVibGlzaGVySWQsIHRpdGxlLCBhZGRyZXNzTG9jYXRpb24sIGFkZHJlc3NTdE51bWJlciwgYWRkcmVzc090aGVyLCBsZW5ndGgsIHdpZHRoLCBoZWlnaHQsIGFyZWEsIGRlc2NyaXB0aW9uLCBwcmljZSwgYWNjZXB0c0Jhcmtlciwgc3VydmVpbGxhbmNlLCBpc0NvdmVyZWQsIGhvdXJTdGFydHMsIGhvdXJFbmRzLCBtb24sIHR1ZSwgd2VkLCB0aHUsIGZyaSwgc2F0LCBzdW4sIGNyZWF0ZWQ6IG5ldyBEYXRlIH0pXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHVzZXIucHVibGlzaGVkU3BvdHMucHVzaChzcG90LmlkKVxuXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3VzZXIuc2F2ZSgpLCBzcG90LnNhdmUoKV0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gZnMubWtkaXIocGF0aC5qb2luKGZpbGVzRGlyLCBzcG90LmlkKSkpXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gc3BvdC5pZClcbiAgICAgICAgfSlcbn1cbiJdfQ==