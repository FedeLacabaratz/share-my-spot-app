function cov_23n6ne5ue1(){var path="/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/retrieve-spots-for-booking-management.js";var hash="42f9bc1349574572ce78d9e673556b44e3a3f0ea";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/retrieve-spots-for-booking-management.js",statementMap:{"0":{start:{line:1,column:35},end:{line:1,column:64}},"1":{start:{line:2,column:21},end:{line:2,column:51}},"2":{start:{line:3,column:26},end:{line:3,column:57}},"3":{start:{line:15,column:0},end:{line:40,column:1}},"4":{start:{line:16,column:4},end:{line:16,column:29}},"5":{start:{line:18,column:4},end:{line:39,column:10}},"6":{start:{line:20,column:12},end:{line:20,column:78}},"7":{start:{line:20,column:23},end:{line:20,column:78}},"8":{start:{line:21,column:12},end:{line:38,column:18}},"9":{start:{line:23,column:20},end:{line:23,column:100}},"10":{start:{line:23,column:32},end:{line:23,column:100}},"11":{start:{line:24,column:20},end:{line:35,column:22}},"12":{start:{line:25,column:24},end:{line:25,column:53}},"13":{start:{line:26,column:24},end:{line:26,column:77}},"14":{start:{line:27,column:24},end:{line:30,column:26}},"15":{start:{line:28,column:28},end:{line:28,column:77}},"16":{start:{line:32,column:24},end:{line:32,column:39}},"17":{start:{line:33,column:24},end:{line:33,column:39}},"18":{start:{line:37,column:20},end:{line:37,column:32}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:15,column:17},end:{line:15,column:18}},loc:{start:{line:15,column:23},end:{line:40,column:1}},line:15},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:14},end:{line:19,column:15}},loc:{start:{line:19,column:22},end:{line:39,column:9}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:22},end:{line:22,column:23}},loc:{start:{line:22,column:31},end:{line:38,column:17}},line:22},"3":{name:"(anonymous_3)",decl:{start:{line:24,column:34},end:{line:24,column:35}},loc:{start:{line:24,column:42},end:{line:35,column:21}},line:24},"4":{name:"(anonymous_4)",decl:{start:{line:27,column:55},end:{line:27,column:56}},loc:{start:{line:27,column:73},end:{line:30,column:25}},line:27}},branchMap:{"0":{loc:{start:{line:20,column:12},end:{line:20,column:78}},type:"if",locations:[{start:{line:20,column:12},end:{line:20,column:78}},{start:{line:20,column:12},end:{line:20,column:78}}],line:20},"1":{loc:{start:{line:23,column:20},end:{line:23,column:100}},type:"if",locations:[{start:{line:23,column:20},end:{line:23,column:100}},{start:{line:23,column:20},end:{line:23,column:100}}],line:23}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"42f9bc1349574572ce78d9e673556b44e3a3f0ea"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_23n6ne5ue1=function(){return actualCoverage;};return actualCoverage;}cov_23n6ne5ue1();const{models:{User,Spot}}=(cov_23n6ne5ue1().s[0]++,require('share-my-spot-data'));const{validate}=(cov_23n6ne5ue1().s[1]++,require('share-my-spot-utils'));const{NotFoundError}=(cov_23n6ne5ue1().s[2]++,require('share-my-spot-errors'));/**
 * Finds my spots that booking candidates have applied to
 * 
 * @param {string} id user's unique id number (owner)
 * 
 * @returns {Promise<string>} returns the spots that I have created for management of proposals
 * 
 * @throws {NotFoundError} on not found user id or spots created with this user id
 */cov_23n6ne5ue1().s[3]++;module.exports=id=>{cov_23n6ne5ue1().f[0]++;cov_23n6ne5ue1().s[4]++;validate.string(id,'id');cov_23n6ne5ue1().s[5]++;return User.findById(id).then(user=>{cov_23n6ne5ue1().f[1]++;cov_23n6ne5ue1().s[6]++;if(!user){cov_23n6ne5ue1().b[0][0]++;cov_23n6ne5ue1().s[7]++;throw new NotFoundError(`user with id ${id} not found`);}else{cov_23n6ne5ue1().b[0][1]++;}cov_23n6ne5ue1().s[8]++;return Spot.find({$and:[{publisherId:id},{bookingCandidates:{$exists:true,$ne:[]}}]}).populate("bookingCandidates","name surname email phone").populate("publisherId","name surname email phone").populate("bookedTo","name surname email phone").lean().then(spots=>{cov_23n6ne5ue1().f[2]++;cov_23n6ne5ue1().s[9]++;if(!spots){cov_23n6ne5ue1().b[1][0]++;cov_23n6ne5ue1().s[10]++;throw new NotFoundError(`no spots were found matching your request`);}else{cov_23n6ne5ue1().b[1][1]++;}cov_23n6ne5ue1().s[11]++;spots.forEach(spot=>{cov_23n6ne5ue1().f[3]++;cov_23n6ne5ue1().s[12]++;spot.id=spot._id.toString();cov_23n6ne5ue1().s[13]++;spot.publisherId.id=spot.publisherId._id.toString();cov_23n6ne5ue1().s[14]++;spot.bookingCandidates.forEach(bookCandidates=>{cov_23n6ne5ue1().f[4]++;cov_23n6ne5ue1().s[15]++;bookCandidates.id=bookCandidates._id.toString();});cov_23n6ne5ue1().s[16]++;delete spot._id;cov_23n6ne5ue1().s[17]++;delete spot.__v;});cov_23n6ne5ue1().s[18]++;return spots;});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLXNwb3RzLWZvci1ib29raW5nLW1hbmFnZW1lbnQuanMiXSwibmFtZXMiOlsibW9kZWxzIiwiVXNlciIsIlNwb3QiLCJyZXF1aXJlIiwidmFsaWRhdGUiLCJOb3RGb3VuZEVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyIsImlkIiwic3RyaW5nIiwiZmluZEJ5SWQiLCJ0aGVuIiwidXNlciIsImZpbmQiLCIkYW5kIiwicHVibGlzaGVySWQiLCJib29raW5nQ2FuZGlkYXRlcyIsIiRleGlzdHMiLCIkbmUiLCJwb3B1bGF0ZSIsImxlYW4iLCJzcG90cyIsImZvckVhY2giLCJzcG90IiwiX2lkIiwidG9TdHJpbmciLCJib29rQ2FuZGlkYXRlcyIsIl9fdiJdLCJtYXBwaW5ncyI6Ind0R0FBQSxLQUFNLENBQUVBLE1BQU0sQ0FBRSxDQUFFQyxJQUFGLENBQVFDLElBQVIsQ0FBViwyQkFBNkJDLE9BQU8sQ0FBQyxvQkFBRCxDQUFwQyxDQUFOLENBQ0EsS0FBTSxDQUFFQyxRQUFGLDJCQUFlRCxPQUFPLENBQUMscUJBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUUsYUFBRiwyQkFBb0JGLE9BQU8sQ0FBQyxzQkFBRCxDQUEzQixDQUFOLENBRUE7Ozs7Ozs7OzJCQVVBRyxNQUFNLENBQUNDLE9BQVAsQ0FBaUJDLEVBQUUsRUFBSSxpREFDbkJKLFFBQVEsQ0FBQ0ssTUFBVCxDQUFnQkQsRUFBaEIsQ0FBb0IsSUFBcEIsRUFEbUIsd0JBR25CLE1BQU9QLENBQUFBLElBQUksQ0FBQ1MsUUFBTCxDQUFjRixFQUFkLEVBQ0ZHLElBREUsQ0FDR0MsSUFBSSxFQUFJLGlEQUNWLEdBQUksQ0FBQ0EsSUFBTCxDQUFXLHlEQUFNLElBQUlQLENBQUFBLGFBQUosQ0FBbUIsZ0JBQWVHLEVBQUcsWUFBckMsQ0FBTixDQUF1RCxDQUFsRSxpQ0FEVSx3QkFFVixNQUFPTixDQUFBQSxJQUFJLENBQUNXLElBQUwsQ0FBVSxDQUFFQyxJQUFJLENBQUUsQ0FBQyxDQUFFQyxXQUFXLENBQUVQLEVBQWYsQ0FBRCxDQUFzQixDQUFFUSxpQkFBaUIsQ0FBRSxDQUFFQyxPQUFPLENBQUUsSUFBWCxDQUFpQkMsR0FBRyxDQUFFLEVBQXRCLENBQXJCLENBQXRCLENBQVIsQ0FBVixFQUE2RkMsUUFBN0YsQ0FBc0csbUJBQXRHLENBQTJILDBCQUEzSCxFQUF1SkEsUUFBdkosQ0FBZ0ssYUFBaEssQ0FBK0ssMEJBQS9LLEVBQTJNQSxRQUEzTSxDQUFvTixVQUFwTixDQUFnTywwQkFBaE8sRUFBNFBDLElBQTVQLEdBQ0ZULElBREUsQ0FDR1UsS0FBSyxFQUFJLGlEQUNYLEdBQUksQ0FBQ0EsS0FBTCxDQUFZLDBEQUFNLElBQUloQixDQUFBQSxhQUFKLENBQW1CLDJDQUFuQixDQUFOLENBQW9FLENBQWhGLGlDQURXLHlCQUVYZ0IsS0FBSyxDQUFDQyxPQUFOLENBQWNDLElBQUksRUFBSSxrREFDbEJBLElBQUksQ0FBQ2YsRUFBTCxDQUFVZSxJQUFJLENBQUNDLEdBQUwsQ0FBU0MsUUFBVCxFQUFWLENBRGtCLHlCQUVsQkYsSUFBSSxDQUFDUixXQUFMLENBQWlCUCxFQUFqQixDQUFzQmUsSUFBSSxDQUFDUixXQUFMLENBQWlCUyxHQUFqQixDQUFxQkMsUUFBckIsRUFBdEIsQ0FGa0IseUJBR2xCRixJQUFJLENBQUNQLGlCQUFMLENBQXVCTSxPQUF2QixDQUErQkksY0FBYyxFQUFJLGtEQUM3Q0EsY0FBYyxDQUFDbEIsRUFBZixDQUFvQmtCLGNBQWMsQ0FBQ0YsR0FBZixDQUFtQkMsUUFBbkIsRUFBcEIsQ0FFSCxDQUhELEVBSGtCLHlCQVFsQixNQUFPRixDQUFBQSxJQUFJLENBQUNDLEdBQVosQ0FSa0IseUJBU2xCLE1BQU9ELENBQUFBLElBQUksQ0FBQ0ksR0FBWixDQUVILENBWEQsRUFGVyx5QkFlWCxNQUFPTixDQUFBQSxLQUFQLENBQ0gsQ0FqQkUsQ0FBUCxDQWtCSCxDQXJCRSxDQUFQLENBc0JILENBekJEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBtb2RlbHM6IHsgVXNlciwgU3BvdCB9IH0gPSByZXF1aXJlKCdzaGFyZS1teS1zcG90LWRhdGEnKVxuY29uc3QgeyB2YWxpZGF0ZSB9ID0gcmVxdWlyZSgnc2hhcmUtbXktc3BvdC11dGlscycpXG5jb25zdCB7IE5vdEZvdW5kRXJyb3IgfSA9IHJlcXVpcmUoJ3NoYXJlLW15LXNwb3QtZXJyb3JzJylcblxuLyoqXG4gKiBGaW5kcyBteSBzcG90cyB0aGF0IGJvb2tpbmcgY2FuZGlkYXRlcyBoYXZlIGFwcGxpZWQgdG9cbiAqIFxuICogQHBhcmFtIHtzdHJpbmd9IGlkIHVzZXIncyB1bmlxdWUgaWQgbnVtYmVyIChvd25lcilcbiAqIFxuICogQHJldHVybnMge1Byb21pc2U8c3RyaW5nPn0gcmV0dXJucyB0aGUgc3BvdHMgdGhhdCBJIGhhdmUgY3JlYXRlZCBmb3IgbWFuYWdlbWVudCBvZiBwcm9wb3NhbHNcbiAqIFxuICogQHRocm93cyB7Tm90Rm91bmRFcnJvcn0gb24gbm90IGZvdW5kIHVzZXIgaWQgb3Igc3BvdHMgY3JlYXRlZCB3aXRoIHRoaXMgdXNlciBpZFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gaWQgPT4ge1xuICAgIHZhbGlkYXRlLnN0cmluZyhpZCwgJ2lkJylcblxuICAgIHJldHVybiBVc2VyLmZpbmRCeUlkKGlkKVxuICAgICAgICAudGhlbih1c2VyID0+IHtcbiAgICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYHVzZXIgd2l0aCBpZCAke2lkfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgcmV0dXJuIFNwb3QuZmluZCh7ICRhbmQ6IFt7IHB1Ymxpc2hlcklkOiBpZCB9LCB7IGJvb2tpbmdDYW5kaWRhdGVzOiB7ICRleGlzdHM6IHRydWUsICRuZTogW10gfX1dIH0pLnBvcHVsYXRlKFwiYm9va2luZ0NhbmRpZGF0ZXNcIiwgXCJuYW1lIHN1cm5hbWUgZW1haWwgcGhvbmVcIikucG9wdWxhdGUoXCJwdWJsaXNoZXJJZFwiLCBcIm5hbWUgc3VybmFtZSBlbWFpbCBwaG9uZVwiKS5wb3B1bGF0ZShcImJvb2tlZFRvXCIsIFwibmFtZSBzdXJuYW1lIGVtYWlsIHBob25lXCIpLmxlYW4oKVxuICAgICAgICAgICAgICAgIC50aGVuKHNwb3RzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzcG90cykgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYG5vIHNwb3RzIHdlcmUgZm91bmQgbWF0Y2hpbmcgeW91ciByZXF1ZXN0YClcbiAgICAgICAgICAgICAgICAgICAgc3BvdHMuZm9yRWFjaChzcG90ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwb3QuaWQgPSBzcG90Ll9pZC50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICBzcG90LnB1Ymxpc2hlcklkLmlkID0gc3BvdC5wdWJsaXNoZXJJZC5faWQudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgc3BvdC5ib29raW5nQ2FuZGlkYXRlcy5mb3JFYWNoKGJvb2tDYW5kaWRhdGVzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29rQ2FuZGlkYXRlcy5pZCA9IGJvb2tDYW5kaWRhdGVzLl9pZC50b1N0cmluZygpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzcG90Ll9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHNwb3QuX192XG5cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3BvdHNcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9KVxufSJdfQ==