function cov_1uuub8bm3n(){var path="/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/update-spot.js";var hash="dd0c50eaac51a36f2ed9630ef85fd71f9dc3641a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/federicolacabaratz/bootcamp/collab/skylab-bootcamp-202001/staff/federico-lacabaratz/share-my-spot/share-my-spot-api/logic/update-spot.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:51}},"1":{start:{line:2,column:35},end:{line:2,column:64}},"2":{start:{line:3,column:26},end:{line:3,column:57}},"3":{start:{line:16,column:0},end:{line:39,column:1}},"4":{start:{line:17,column:4},end:{line:17,column:37}},"5":{start:{line:18,column:4},end:{line:18,column:39}},"6":{start:{line:19,column:4},end:{line:19,column:37}},"7":{start:{line:21,column:4},end:{line:37,column:8}},"8":{start:{line:23,column:21},end:{line:23,column:48}},"9":{start:{line:24,column:8},end:{line:24,column:78}},"10":{start:{line:24,column:19},end:{line:24,column:78}},"11":{start:{line:26,column:8},end:{line:26,column:132}},"12":{start:{line:28,column:21},end:{line:28,column:48}},"13":{start:{line:29,column:8},end:{line:29,column:78}},"14":{start:{line:29,column:19},end:{line:29,column:78}},"15":{start:{line:31,column:8},end:{line:31,column:33}},"16":{start:{line:33,column:8},end:{line:33,column:25}},"17":{start:{line:35,column:8},end:{line:35,column:19}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:17},end:{line:16,column:18}},loc:{start:{line:16,column:43},end:{line:39,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:12},end:{line:21,column:13}},loc:{start:{line:21,column:23},end:{line:37,column:5}},line:21}},branchMap:{"0":{loc:{start:{line:24,column:8},end:{line:24,column:78}},type:"if",locations:[{start:{line:24,column:8},end:{line:24,column:78}},{start:{line:24,column:8},end:{line:24,column:78}}],line:24},"1":{loc:{start:{line:29,column:8},end:{line:29,column:78}},type:"if",locations:[{start:{line:29,column:8},end:{line:29,column:78}},{start:{line:29,column:8},end:{line:29,column:78}}],line:29}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"dd0c50eaac51a36f2ed9630ef85fd71f9dc3641a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1uuub8bm3n=function(){return actualCoverage;};return actualCoverage;}cov_1uuub8bm3n();const{validate}=(cov_1uuub8bm3n().s[0]++,require('share-my-spot-utils'));const{models:{User,Spot}}=(cov_1uuub8bm3n().s[1]++,require('share-my-spot-data'));const{NotFoundError}=(cov_1uuub8bm3n().s[2]++,require('share-my-spot-errors'));/**
 * Updates the spot info
 * 
 * @param {string} userId user's unique id
 * @param {object} body the elements that will be updated
 * @param {string} spotId spot's unique id
 * 
 * @returns {Promise<string>} an empty Promise on a successful update
 * 
 */cov_1uuub8bm3n().s[3]++;module.exports=(userId,body,spotId)=>{cov_1uuub8bm3n().f[0]++;cov_1uuub8bm3n().s[4]++;validate.string(userId,'userId');cov_1uuub8bm3n().s[5]++;validate.type(body,'body',Object);cov_1uuub8bm3n().s[6]++;validate.string(spotId,'spotId');cov_1uuub8bm3n().s[7]++;return(async()=>{cov_1uuub8bm3n().f[1]++;const user=(cov_1uuub8bm3n().s[8]++,await User.findById(userId));cov_1uuub8bm3n().s[9]++;if(!user){cov_1uuub8bm3n().b[0][0]++;cov_1uuub8bm3n().s[10]++;throw new NotFoundError(`user with id ${userId} not found`);}else{cov_1uuub8bm3n().b[0][1]++;}cov_1uuub8bm3n().s[11]++;await Spot.findOneAndUpdate({_id:spotId,publisherId:userId},{$set:body,bookingCandidates:[],status:'available'});const spot=(cov_1uuub8bm3n().s[12]++,await Spot.findById(spotId));cov_1uuub8bm3n().s[13]++;if(!spot){cov_1uuub8bm3n().b[1][0]++;cov_1uuub8bm3n().s[14]++;throw new NotFoundError(`spot with id ${spotId} not found`);}else{cov_1uuub8bm3n().b[1][1]++;}cov_1uuub8bm3n().s[15]++;spot.bookedTo=undefined;cov_1uuub8bm3n().s[16]++;await spot.save();cov_1uuub8bm3n().s[17]++;return spot;})();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwZGF0ZS1zcG90LmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIlVzZXIiLCJTcG90IiwiTm90Rm91bmRFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJ1c2VySWQiLCJib2R5Iiwic3BvdElkIiwic3RyaW5nIiwidHlwZSIsIk9iamVjdCIsInVzZXIiLCJmaW5kQnlJZCIsImZpbmRPbmVBbmRVcGRhdGUiLCJfaWQiLCJwdWJsaXNoZXJJZCIsIiRzZXQiLCJib29raW5nQ2FuZGlkYXRlcyIsInN0YXR1cyIsInNwb3QiLCJib29rZWRUbyIsInVuZGVmaW5lZCIsInNhdmUiXSwibWFwcGluZ3MiOiJtb0ZBQUEsS0FBTSxDQUFFQSxRQUFGLDJCQUFlQyxPQUFPLENBQUMscUJBQUQsQ0FBdEIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsTUFBTSxDQUFFLENBQUVDLElBQUYsQ0FBUUMsSUFBUixDQUFWLDJCQUE2QkgsT0FBTyxDQUFDLG9CQUFELENBQXBDLENBQU4sQ0FDQSxLQUFNLENBQUVJLGFBQUYsMkJBQW9CSixPQUFPLENBQUMsc0JBQUQsQ0FBM0IsQ0FBTixDQUVBOzs7Ozs7Ozs7MkJBV0FLLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxNQUFELENBQVNDLElBQVQsQ0FBZUMsTUFBZixHQUEwQixpREFDdkNWLFFBQVEsQ0FBQ1csTUFBVCxDQUFnQkgsTUFBaEIsQ0FBd0IsUUFBeEIsRUFEdUMsd0JBRXZDUixRQUFRLENBQUNZLElBQVQsQ0FBY0gsSUFBZCxDQUFvQixNQUFwQixDQUE0QkksTUFBNUIsRUFGdUMsd0JBR3ZDYixRQUFRLENBQUNXLE1BQVQsQ0FBZ0JELE1BQWhCLENBQXdCLFFBQXhCLEVBSHVDLHdCQUt2QyxNQUFPLENBQUMsU0FBVyx5QkFFZixLQUFNSSxDQUFBQSxJQUFJLDBCQUFHLEtBQU1YLENBQUFBLElBQUksQ0FBQ1ksUUFBTCxDQUFjUCxNQUFkLENBQVQsQ0FBVixDQUZlLHdCQUdmLEdBQUksQ0FBQ00sSUFBTCxDQUFXLDBEQUFNLElBQUlULENBQUFBLGFBQUosQ0FBbUIsZ0JBQWVHLE1BQU8sWUFBekMsQ0FBTixDQUEyRCxDQUF0RSxpQ0FIZSx5QkFLZixLQUFNSixDQUFBQSxJQUFJLENBQUNZLGdCQUFMLENBQXNCLENBQUVDLEdBQUcsQ0FBRVAsTUFBUCxDQUFlUSxXQUFXLENBQUVWLE1BQTVCLENBQXRCLENBQTRELENBQUVXLElBQUksQ0FBRVYsSUFBUixDQUFjVyxpQkFBaUIsQ0FBRSxFQUFqQyxDQUFxQ0MsTUFBTSxDQUFFLFdBQTdDLENBQTVELENBQU4sQ0FFQSxLQUFNQyxDQUFBQSxJQUFJLDJCQUFHLEtBQU1sQixDQUFBQSxJQUFJLENBQUNXLFFBQUwsQ0FBY0wsTUFBZCxDQUFULENBQVYsQ0FQZSx5QkFRZixHQUFJLENBQUNZLElBQUwsQ0FBVywwREFBTSxJQUFJakIsQ0FBQUEsYUFBSixDQUFtQixnQkFBZUssTUFBTyxZQUF6QyxDQUFOLENBQTJELENBQXRFLGlDQVJlLHlCQVVmWSxJQUFJLENBQUNDLFFBQUwsQ0FBZ0JDLFNBQWhCLENBVmUseUJBWWYsS0FBTUYsQ0FBQUEsSUFBSSxDQUFDRyxJQUFMLEVBQU4sQ0FaZSx5QkFjZixNQUFPSCxDQUFBQSxJQUFQLENBRUgsQ0FoQk0sR0FBUCxDQWtCSCxDQXZCRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgdmFsaWRhdGUgfSA9IHJlcXVpcmUoJ3NoYXJlLW15LXNwb3QtdXRpbHMnKVxuY29uc3QgeyBtb2RlbHM6IHsgVXNlciwgU3BvdCB9IH0gPSByZXF1aXJlKCdzaGFyZS1teS1zcG90LWRhdGEnKVxuY29uc3QgeyBOb3RGb3VuZEVycm9yIH0gPSByZXF1aXJlKCdzaGFyZS1teS1zcG90LWVycm9ycycpIFxuXG4vKipcbiAqIFVwZGF0ZXMgdGhlIHNwb3QgaW5mb1xuICogXG4gKiBAcGFyYW0ge3N0cmluZ30gdXNlcklkIHVzZXIncyB1bmlxdWUgaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSBib2R5IHRoZSBlbGVtZW50cyB0aGF0IHdpbGwgYmUgdXBkYXRlZFxuICogQHBhcmFtIHtzdHJpbmd9IHNwb3RJZCBzcG90J3MgdW5pcXVlIGlkXG4gKiBcbiAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz59IGFuIGVtcHR5IFByb21pc2Ugb24gYSBzdWNjZXNzZnVsIHVwZGF0ZVxuICogXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSAodXNlcklkLCBib2R5LCBzcG90SWQpID0+IHtcbiAgICB2YWxpZGF0ZS5zdHJpbmcodXNlcklkLCAndXNlcklkJylcbiAgICB2YWxpZGF0ZS50eXBlKGJvZHksICdib2R5JywgT2JqZWN0KVxuICAgIHZhbGlkYXRlLnN0cmluZyhzcG90SWQsICdzcG90SWQnKVxuXG4gICAgcmV0dXJuIChhc3luYyAoKT0+IHtcblxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh1c2VySWQpXG4gICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYHVzZXIgd2l0aCBpZCAke3VzZXJJZH0gbm90IGZvdW5kYClcblxuICAgICAgICBhd2FpdCBTcG90LmZpbmRPbmVBbmRVcGRhdGUoeyBfaWQ6IHNwb3RJZCwgcHVibGlzaGVySWQ6IHVzZXJJZCB9LCB7ICRzZXQ6IGJvZHksIGJvb2tpbmdDYW5kaWRhdGVzOiBbXSwgc3RhdHVzOiAnYXZhaWxhYmxlJ30pXG5cbiAgICAgICAgY29uc3Qgc3BvdCA9IGF3YWl0IFNwb3QuZmluZEJ5SWQoc3BvdElkKVxuICAgICAgICBpZiAoIXNwb3QpIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKGBzcG90IHdpdGggaWQgJHtzcG90SWR9IG5vdCBmb3VuZGApXG4gICAgICAgIFxuICAgICAgICBzcG90LmJvb2tlZFRvID0gdW5kZWZpbmVkXG5cbiAgICAgICAgYXdhaXQgc3BvdC5zYXZlKClcblxuICAgICAgICByZXR1cm4gc3BvdFxuICAgIFxuICAgIH0pKClcblxufSJdfQ==